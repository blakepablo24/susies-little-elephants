{% extends 'admin/base.html.twig' %}

{% block main %}

    <main>

        <h3 class="main-title">{{child.name}}'s Time-line</h3>

        {% if is_granted('ROLE_ADMIN') %}

            <a id="add-new-time-line-post-form-button" href="javascript:void(0)" onclick="revealPostForm()"><i class="fas fa-plus"></i> Add New Post</a>
            <a id="hide-new-time-line-post-form-button" href="javascript:void(0)" onclick="hidePostForm()"><i class="fas fa-minus"></i> Hide</a>

            {# Post form hidden until add post is clicked #}

            {{form_start(form, {'attr': {'novalidate':'novalidate', 'id': 'new-time-line-post-form', 'class': 'edit-family-form'}})}}
                    {{ form_row(form.subject) }}
                    {{ form_row(form.content) }}
            <div class="form-errors">
                
                    {{form_errors(form.subject)}}
                    {{form_errors(form.content)}}
                
                </div>

            {{form_end(form)}}

        {% endif %}
        
        {% for post in childs_posts %}

            <div class="timeline-post">
                <div class="timeline-post-headers">
                    <h3>{{post.subject}}</h3>
                    <h4>{{post.date|date('D-d-m-y')}}</h4>
        
                    {% if not is_granted('ROLE_ADMIN') %}

                    {% else %}
                        <a id="edit-family" href="{{path('edit_post', {'postname':post.subject|lower|slugify,'id':post.id})}}">edit</a>
                        <a id="delete-family" onclick="return confirm('Are you sure you want to delete this post?')" href="{{path('delete_post', {'id':post.id})}}"><h4>delete</h4></a>                
                    {% endif %}
        
                </div>

                <p>{{post.content}}</p>

                <div class="timeline-post-image-container">
                    <h5>Attached Image</h5>
                    <img  id="timeline-post-mini-image" class="timeline-post-image allPostImages" src="{{asset('assets/img/posts/' ~ post.imageFileName)}}" alt="">
                    {% if not is_granted('ROLE_ADMIN') %}

                        <a class="timeline-post-contact" href=""><i class="far fa-envelope"></i><p>Contact Susie regarding this post</p></a>
                
                    {% endif %}
                </div>

            </div>

        {% endfor %}

        {# Modal for enlarging timeline post images #}

        <div id="enlargeImageModal" class="enlarge-image-modal-background">
            <span class="enlarge-image-modal-close-btn">&times;</span>
            <img class="enlarge-image-modal-image" id="img01">
            <div id="caption"></div>
        </div>
    </main>

{% endblock %}